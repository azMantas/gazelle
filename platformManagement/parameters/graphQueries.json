{
    "customeRole": {
        "query": "authorizationresources\r\n| where type == 'microsoft.authorization/roledefinitions'\r\n| where properties.type != \"BuiltInRole\"\r\n| mv-expand permissions = parse_json(properties.permissions)\r\n| extend roleName = tostring(properties.roleName)\r\n| extend actions = permissions.actions\r\n| extend notActions = permissions.notActions\r\n| extend dataActions = permissions.notActions\r\n| extend notDataActions = permissions.notActions\r\n| project id, roleName, actions, notActions, dataActions, notDataActions\r\n| join kind=innerunique (\r\n    authorizationresources\r\n    | where type == 'microsoft.authorization/roleassignments'\r\n    | extend roleDefinitionId = tostring(properties.roleDefinitionId)\r\n    | extend objectId = tostring(properties.principalId)\r\n    | extend scope = tostring(properties.scope)\r\n    )\r\n    on $left.id == $right.roleDefinitionId\r\n| project roleName, objectId, scope, actions, notActions, dataActions, notDataActions"
    }
}


